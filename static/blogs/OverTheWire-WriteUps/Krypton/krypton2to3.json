{"blog_content": "<a href='https://overthewire.org/wargames/krypton/' target='_blank' rel='noopener'>Krypton</a> is a war-game presented by <a href='https://overthewire.org/' target='_blank' rel='noopener'>OverTheWire.org</a> that aims at teaching about <strong>Cryptography</strong>. During this series we will look various Cryptography techniques and how to approach a problem/challenge involving Cryptography. In this writeup we will solve Krypton level 2 to gain password for Krypton level 3.<br /><br />The prompt for level 2 is - <br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Krypton/krypton2to3/krypton2to3_1.webp' alt='Prompt for level 2' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Prompt for level 2.</figcaption></figure></div></div><br /><br />According to the prompt the <strong>\"cipher\"</strong> used this time is <strong>Caesar Cipher</strong>. In previous level's cipher <strong>ROT13</strong> is similar to Caesar Cipher in a sense that the letters are rotated by a single fixed number called the <strong>key</strong>, but unlike Caesar cipher, ROT 13 always rotates the alphabets by a count of <strong>13</strong> whereas in the Caesar Cipher the key can be any number between 1 and 26, the key will always remain same throughout the run. The key by which the alphabets are to be rotated can also be neagtive. In case of negative key the rotation will happen from left, that is for the key -1, A -> Z and so on.<br /><br /><strong>Note: Keys exceeding 26 have the same effect as (key - 26). Keys less than 1 will have the same effect as (27 - key).</strong><br /><br />Logging into the level using SSH and navigating to the <strong>/krypton/krypton2/</strong> to find the encrypted password for <strong>krypton3</strong>. <br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Krypton/krypton2to3/krypton2to3_2.webp' alt='Encrypted krypton3 password' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Encrypted krypton3 password.</figcaption></figure></div></div><br /><br />The encrypted password for krypton3 is <strong>OMQEMDUEQMEK</strong>.<br /><br />An easy way to crack Caesar cipher is to brute force it, with a limited global key set (only 26 possible keys), caesar cipher can be easily brute forced. There are various online tools available to brute force caesar cipher, in CTFs I tend to use <a href='https://www.dcode.fr/caesar-cipher' target='_blank' rel='noopener'>dcode.fr/caesar-cipher</a> as my goto online tool.<br /><br />For this particular excercise, I have written a small utility in python to brute force all possible values of a caesar cipher's encoded string. The code is as follows - <br /><br /><pre class='line-numbers' style='max-height: 500px;'><code class='language-python match-braces'>encrypted_string = 'OMQEMDUEQMEK'\n\nfor i in range(1,27):\n    temp_str = \"\"\n    for x in encrypted_string:\n        int_val = ord(x) + i\n        if int_val &gt; 90:\n            # 90 is the numerical value for 'Z'\n            # 65 is the numerical value for 'A'\n            # If int_val is greater than Z then \n            # the number is greater then 90 then \n            # we must again count the difference \n            # from A.\n            int_val = 64 + (int_val - 90)\n        temp_str += chr(int_val)    \n    print(f\"{i} {temp_str}\")\n</code></pre><br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Krypton/krypton2to3/krypton2to3_3.webp' alt='Brute forcing caesar cipher using python' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Brute forcing caesar cipher using python.</figcaption></figure></div></div><br /><br /><strong>Note: In most of the such challenge, the decoded string that makes the most sense in normal english is the answer.</strong><br /><br />This small code will brute force any caeser cipher encoded string. A more exhaustive utility is present in the Github repository of this blog <a href='https://github.com/draggers21/draggers21.github.io/blob/main/static/codes_used_in_writeups/krypton2to3/ceaser_cipher_brute_forcer.py' target='_blank' rel='noopener'>(View ceaser_cipher_brute_forcer.py on Github)</a><br /><br /><strong>The password for krypton3 is: CAESARISEASY</strong>"}