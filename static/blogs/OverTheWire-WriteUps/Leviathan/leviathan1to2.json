{
    "blog_content": "In this write-up we will be solving Leviathan level 1 in order to get the password for next level, i.e. level 2, We got the password for Level 1 in the previous write-up. (<a href='view.html?id=0df7c7c594c3593eeae08a80ecf201329c9753d2a7c2e6bd2371d3919bec0ed6' target='_blank'>Read OverTheWire: Leviathan: Solving Leviathan 0 -> Leviathan 1</a>)<br /><br />The prompt for this level is - <br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_1.webp' alt='Prompt for level 1' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Prompt for Leviathan Level 1</figcaption></figure></div></div><br /><br />Nothing as usual to work on, let's SSH onto the sever using credentials <strong>leviathan1</strong> and password <strong>rioGegei8m</strong>.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_2.webp' alt='SSHing into the server' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>SSHing into the server.</figcaption></figure></div></div><br /><br />Using <strong>'pwd'</strong> to check the directory we are currently in.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_3.webp' alt='Output of pwd command' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of 'pwd' command</figcaption></figure></div></div><br /><br />Great, we are in the home directory. Let's use and <strong>'ls -la'</strong> to see all the files in the directory.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_5.webp' alt='Output of ls -la command' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of 'ls -la' command</figcaption></figure></div></div><br /><br />There seems to be a file named <strong>'check'</strong>. Let's check what type of file <strong>'check'</strong> is.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_6.webp' alt='Output of file command' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of 'file check' command</figcaption></figure></div></div><br /><br /><strong>'check'</strong> seems to be elf executable and is not stripped. Let's use <strong>'strings'</strong> and <strong>'grep'</strong> to check for the password of <strong>'leviathan2'</strong>, using the command <strong>'strings check | grep leviathan2'</strong>.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_4_mod.webp' alt='output of strings and grep command' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of command 'strings check | grep leviathan2'</figcaption></figure></div></div><br /><br />This doesn't give us any results, let's try executing <strong>'check'</strong> to see what the binary is.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_7.webp' alt='Executing check file' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Executing the file 'check'</figcaption></figure></div></div><br /><br />It is asking for a <strong>'password'</strong>, let's try '1234' (we can use any random string) first to see the behaviour of the file.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_8.webp' alt='Output against 1234 as password' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Output against '1234' as password.</figcaption></figure></div></div><br /><br />It shows 'Wrong password...' and exits.<br /><br />let's again use <strong>'strings'</strong> but this time, we won't filter out the results using <strong>'grep'</strong>, instead we will examine all the strings inside the binary <strong>'check'</strong> to see if we can find the password that is being used by the said binary. Using command <strong>'strings check'</strong>.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_9.webp' alt='Examining various strings in check' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Examining various strings in 'check' using command 'strings check'.</figcaption></figure></div></div><br /><br />There seems to be multiple strings, but since none of them make actual sense except <strong>'love'</strong>, let's use that as the password. One more interesting thing is that it uses <strong>'/bin/sh'</strong> to do something, it can be assumed that it will execute a shell once we enter the right password.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_10.webp' alt='Using love as password' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Using 'love' as password.</figcaption></figure></div></div><br /><br />Hmm, no luck. In that case let's use <strong>'ltrace'</strong>. <strong>'ltrace'</strong> is linux system tool that runs a program (or command) and intercepts and records the dynamic library calls made by the said program (or command). Use the following command, <strong>'ltrace ./check'</strong>. It will ask us for the password, let's again enter 'love' as password. <br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_11.webp' alt='Output of ltrace' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of 'ltrace ./check'.</figcaption></figure></div></div><br /><br />Here we can see the binary uses <strong>'strcmp'</strong> function, 'strcmp' is a function defined in 'strings.h' header file, used in C and C++. This function just compares two strings, case sensitive and <strong>returns boolean 'True or 'False'</strong>...<strong>'Usage: strcmp(string1, string2)'</strong>. Now we can see that it is comparing the first three characters of our input with the string 'sex', so that means if our input's first three letters are 'sex', we able to pass whatever check this is doing. Again running the binary 'check' and using 'sex' as password (Just using 'sex' as the password will be more easy).<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_12.webp' alt='Successful entry of password' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Shell executed upon successful check of password.</figcaption></figure></div></div><br /><br />Voila, this seem to have worked, and it has given us a shell. Now let's check what user is the process running the shell, to do so, we will use the command <strong>'whoami'</strong>. <br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_13.webp' alt='Output of whoami' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of command 'whoami'.</figcaption></figure></div></div><br /><br />As the output suggests, we are <strong>'leviathan2'</strong>, so now we can access files that belong to the user leviathan2. As per the homepage of the war-game (<a href='https://overthewire.org/wargames/leviathan/' target='_blank'>OverTheWire: Leviathan</a>) all the password files for a particular level are located in <strong>'/etc/leviathan_pass/'</strong>. Since we are <strong>'leviathan2'</strong> we can access files that belong to it. Let's use <strong>'cat'</strong> to see the password for the leviathan2, using the command <strong>'cat /etc/leviathan_pass/leviathan2'</strong>.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan1to2/leviathan1to2_14.webp' alt='password of leviathan2 in /etc/leviathan_pass/leviathan2' onclick='magnify(this.src)' class='figure-img img-fluid  blog-image'><figcaption class='figure-caption blog-fig-caption'>Using 'cat' command to view the password of leviathan2 in /etc/leviathan_pass/leviathan2.</figcaption></figure></div></div><br /><br />We have the password for leviathan2.<br /><br /><strong>Password of Leviathan2 : ougahZi8Ta</strong>"    
}