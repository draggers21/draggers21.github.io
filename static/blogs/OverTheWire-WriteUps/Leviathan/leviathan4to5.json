{"blog_content": "<a href='https://overthewire.org/wargames/leviathan/' target='_blank' rel='noopener'>Leviathan</a> is a war-game presented by <a href='https://overthewire.org/' target='_blank' rel='noopener'>OverTheWire.org</a> that tests players knowledge of linux commands and linux file system and some basic exploitation skills. In this writeup we will try and solve Leviathan Level 4 to get the key for Level 5.<br /><br />The prompt for this level is -<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan4to5/leviathan4to5_1.webp' alt='Prompt for level 4' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Prompt for level 4.</figcaption></figure></div></div><br /><br />Nothing as usual, let's try SSHing into the server using the credentials, <strong>username: leviathan4</strong> and <strong>password: vuH0coox6m</strong>, we got this password after solving the previous challenge. <a href='view.html?id=0d431468614379199d1fba64b0d8db3af68391ba1acde3b404f3ed2cec087d18' target='_blank' rel='noopener'>(Read OverTheWire: Leviathan: Solving Leviathan 3 -> Leviathan 4)</a><br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan4to5/leviathan4to5_2.webp' alt='SSHing onto the server' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>SSHing onto the server.</figcaption></figure></div></div><br /><br />Using <strong>whoami</strong>, <strong>pwd</strong>, <strong>ls -la</strong> to get some basic knowledge about the user, current working directory and the contents of the directory respectively.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan4to5/leviathan4to5_3.webp' alt='Gathering basic info about the system' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Gathering basic info about the system.</figcaption></figure></div></div><br /><br />There's a hidden folder named <strong>.trash</strong>. As explained in the Leviathan 0 -> Leviathan 1 writeup <a href='view.html?id=0df7c7c594c3593eeae08a80ecf201329c9753d2a7c2e6bd2371d3919bec0ed6' target='_blank' rel='noopener'>(Read OverTheWire: Leviathan: Solving Leviathan 0 -> Leviathan 1)</a> <strong>.</strong> is used to hide a file or a directory in Linux. <br /><br />Navigating to the folder <strong>.trash</strong> using the command <strong>cd .trash</strong> and using the command <strong>ls -la</strong> to view the contents of the folder. <br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan4to5/leviathan4to5_4.webp' alt='Navigating to the hidden folder' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Navigating to '.trash' folder.</figcaption></figure></div></div><br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan4to5/leviathan4to5_5.webp' alt='Viewing contents of the directory' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Viewing contents of the directory using 'ls -la'.</figcaption></figure></div></div><br /><br />There seems to be a file called <strong>bin</strong>, first let's check what type of file <strong>bin</strong> is using the command <strong>file bin</strong>.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan4to5/leviathan4to5_6.webp' alt='Output of file command' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of command 'file bin'.</figcaption></figure></div></div><br /><br /><strong>bin</strong> seems to be an ELF executable, meaning that we can execute it just like previous levels, let's try running it using the command <strong>./bin</strong>.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan4to5/leviathan4to5_7.webp' alt='Output of bin file' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of the 'bin' binary.</figcaption></figure></div></div><br /><br />It seems that we do not have to interact with the binary, but instead it has printed a weird output to the screen. you might have noticed that this is binary. Let's use an online tool to convert this binary string to an ASCII string which we can understand.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan4to5/leviathan4to5_8.webp' alt='Converting binary to ascii' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Converting binary string to ASCII.</figcaption></figure></div></div><br /><br />We have the password for leviathan5.<br /><br /><strong>Password for leviathan5 is: Tith4cokei</strong>"}