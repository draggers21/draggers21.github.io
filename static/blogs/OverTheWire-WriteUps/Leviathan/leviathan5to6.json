{"blog_content": "<a href='https://overthewire.org/wargames/leviathan/' target='_blank' rel='noopener'>Leviathan</a> is a war-game presented by <a href='https://overthewire.org/' target='_blank' rel='noopener'>OverTheWire.org</a> that tests players knowledge of linux commands and linux file system and some basic exploitation skills. In this writeup we will try and solve Leviathan Level 5 to get the key for Level 6.<br /><br />The prompt for this level is -<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan5to6/leviathan5to6_1.webp' alt='Prompt for level 5' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Prompt for level 5.</figcaption></figure></div></div><br /><br />Nothing as usual, Let's SSH into the server using the credentials <strong>username: leviathan5</strong> and <strong>password: Tith4cokei</strong> which we got by solving the previous level in this series. <a href='view.html?id=8a36fc1dcfa37c4802ea17b4a841ee8c21ded2a0b67bb7aa208221ef260caeb0' target='_blank' rel='noopener'>(Read OverTheWire: Leviathan: Solving Leviathan 4 -> Leviathan 5)</a><br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan5to6/leviathan5to6_2.webp' alt='SSHing into the server' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>SSHing into the server.</figcaption></figure></div></div><br /><br />Using <strong>whoami</strong>, <strong>pwd</strong>, <strong>ls -la</strong> to get some basic knowledge about the user, current working directory and the contents of the directory respectively.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan5to6/leviathan5to6_3.webp' alt='Gathering basic info about the system' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Gathering basic information about the system.</figcaption></figure></div></div><br /><br />There's a binary called <strong>leviathan5</strong>, let's try executing it to see what it does.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan5to6/leviathan5to6_4.webp' alt='Output of binary' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of binary prior to modifications.</figcaption></figure></div></div><br /><br />The binary exits with the message <strong>Cannot find /tmp/file.log</strong>. Seems like the binary has to do something with <strong>file.log</strong> located in the <strong>/tmp/</strong> directory, it may be checking permissions of the file using <strong>access()</strong> or trying to open it using <strong>open()</strong>. In order to figure this out let's use <strong>ltrace</strong> to see what the binary is doing using the command <strong>ltrace ./leviathan5</strong>.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan5to6/leviathan5to6_5.webp' alt='Output of ltrace ./leviathan5' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of 'ltrace ./leviathan5'</figcaption></figure></div></div><br /><br />As per the output of ltrace the binary is opening the file <strong>/tmp/file.log</strong> in read mode, most probably it will be using this to display what the contents of the file are. <br /><br />We can exploit this by using <strong>symbolic links</strong>, they were also used while solving leviathan level2 <a href='view.html?id=5935493193db9a861c47d50f44d3c87e9f1e8005e60fb059ce5ee1fae5c09a8a' target='_blank' rel='noopener'>(Read OverTheWire: Leviathan: Solving Leviathan 2 -> Leviathan 3)</a> , what we can do is that create a file named <strong>file.log</strong> in <strong>/tmp/</strong> directory and link it to <strong>/etc/leviathan_pass/leviathan6</strong>, since the binary's owner is leviathan6 (See image 3), it would open the password file for leviathan6. To create a symbolic link to password file use the following command - <strong>ln -s /etc/leviathan_pass/leviathan6 /tmp/file.log</strong>.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan5to6/leviathan5to6_6.webp' alt='Creating a symbolic link to leviathan6 password file.' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Creating a symbolic link to leviathan6 password file.</figcaption></figure></div></div><br /><br />Now let's re run the binary to see what happens, using the command <strong>./leviathan5</strong>.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan5to6/leviathan5to6_7.webp' alt='Output of binary after symbolic link' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of binary after creating a symbolic link.</figcaption></figure></div></div><br /><br />Great, we now have the password for leviathan6.<br /><br /><strong>Password for leviathan6 is: UgaoFee4li</strong>"}