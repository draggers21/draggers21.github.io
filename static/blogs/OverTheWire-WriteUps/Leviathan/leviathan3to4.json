{"blog_content": "<a href='https://overthewire.org/wargames/leviathan/' target='_blank' rel='noopener'>Leviathan</a> is a war-game presented by <a href='https://overthewire.org/' target='_blank' rel='noopener'>OverTheWire.org</a> that tests players knowledge of linux commands and linux file system and some basic exploitation skills. In this writeup we will try and solve Leviathan Level 3 to get the key for Level 4.<br /><br />The prompt for this level is - <br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan3to4/leviathan3to4_1.webp' alt='Prompt for level 3' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Prompt for leviathan level3.</figcaption></figure></div></div><br /><br />As usual nothing to work with. Let's SSH into the server using the <strong>username: leviathan3</strong> and <strong>password: Ahdiemoo1j</strong> which we got after solving the previous level. <a href='view.html?id=5935493193db9a861c47d50f44d3c87e9f1e8005e60fb059ce5ee1fae5c09a8a' target='_blank' rel='noopener'>(Read OverTheWire: Leviathan: Solving Leviathan 2 -> Leviathan 3)</a><br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan3to4/leviathan3to4_2.webp' alt='SSHing onto the server' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>SSHing onto the server.</figcaption></figure></div></div><br /><br />Using <strong>whoami</strong>, <strong>pwd</strong>, <strong>ls -la</strong> to get some basic knowledge about the user, current working directory and the contents of the directory respectively.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan3to4/leviathan3to4_3.webp' alt='Gathering basic information about the server.' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Gathering basic information about the server.</figcaption></figure></div></div><br /><br />Looks like there is a binary called <strong>level3</strong>, let's try running it.<br /><br />Entering some random password to see the flow of the binary.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan3to4/leviathan3to4_4.webp' alt='Pre running the binary to check the flow' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Running binary to check the flow.</figcaption></figure></div></div><br /><br />The password didn't work, obviously. This seems similar to Leviathan Level2, let's use <strong>ltrace</strong> directly instead of scrounging through the binary itself, using the command - <strong>ltrace ./level3</strong> and entering some random string. <br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan3to4/leviathan3to4_5.webp' alt='ltrace output against a random string' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>'ltrace' output against a random string.</figcaption></figure></div></div><br /><br />We can see that it is first comparing two strings, but these strings seem static and also they are being compared before the binary asks for the password, so seems that the first string comparission is the one that we need. But right after inputting the password we can see another <strong>strcmp()</strong>, this one unlike the first one, compares the string that we inputted with a static string, so only if we enter the same string we will be able to satisfy the check. As we can see the binary is comparing out input to <strong>snlprintf\\n</strong>, so let's try running the binary again and this time, let's input <strong>snlprintf\\n</strong> as the password.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan3to4/leviathan3to4_6.webp' alt='ltrace output against snlprintf\\n string' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>'ltrace' output against the string 'snlprintf\\n'.</figcaption></figure></div></div><br /><br />This also doesn't seem to work, analyzing the <strong>ltrace</strong> output we can see that our input <strong>snlprintf\\n</strong> has another new-line character in the end, so maybe we do not need the extra new-line character in out input, let's re run the binary and use <strong>snlprintf</strong> as the password this time. <br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan3to4/leviathan3to4_7.webp' alt='ltrace output against snlprintf string' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>'ltrace' output against the string 'snlprintf'.</figcaption></figure></div></div><br /><br />Great this worked and now we have a shell, let's use <strong>whoami</strong> to see what user we are.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan3to4/leviathan3to4_8.webp' alt='output of command whoami' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of the command 'whoami'.</figcaption></figure></div></div><br /><br />Looks like we are <strong>leviathan4</strong>, this means that we do not need to do anything else, we can simply output the password of leviathan4, using the command - <strong>cat /etc/leviathan_pass/leviathan4</strong>. <br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan3to4/leviathan3to4_9.webp' alt='Using cat to view the password' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Using 'cat' to see the password of leviathan4.</figcaption></figure></div></div><br /><br /><br /><br /><strong>Password for leviathan4 is: vuH0coox6m</strong>"}