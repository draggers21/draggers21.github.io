{"blog_content": "<a href='https://overthewire.org/wargames/leviathan/' target='_blank' rel='noopener'>Leviathan</a> is a war-game presented by <a href='https://overthewire.org/' target='_blank' rel='noopener'>OverTheWire.org</a> that tests players knowledge of linux commands and linux file system and some basic exploitation skills. In this writeup we will try and solve Leviathan Level 6 to get the key for Level 7.<br /><br /><strong>This is the last challenge in the Leviathan series</strong>, the prompt for this level is - <br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan6to7/leviathan6to7_1.webp' alt='Prompt for level 6' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Prompt for level 6.</figcaption></figure></div></div><br /><br />As usual nothing, let's SSH into the server using the credentials <strong>username: leviathan6</strong> and <strong>password: UgaoFee4li</strong>. We got these credentials by solving the last challenge. <a href='view.html?id=cb42290b8c0c33bde477b24b712d694975ac0722426fc1756ca271a6b58bb87b' target='_blank' rel='noopener'>(Read OverTheWire: Leviathan: Solving Leviathan 5 -> Leviathan 6)</a><br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan6to7/leviathan6to7_2.webp' alt='SSHing into the server' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>SSHing into the server.</figcaption></figure></div></div><br /><br />Using <strong>whoami</strong>, <strong>pwd</strong>, <strong>ls -la</strong> to get some basic knowledge about the user, current working directory and the contents of the directory respectively.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan6to7/leviathan6to7_3.webp' alt='Gathering basic information about the system' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Gathering basic information about the system.</figcaption></figure></div></div><br /><br />There's a binary called <strong>leviathan5</strong>, let's try executing it to see what it does.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan6to7/leviathan6to7_4.webp' alt='Running the binary.' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Running the binary.</figcaption></figure></div></div><br /><br />The output states that we need pass a command line argument that must a 4 digit code. Trying <strong>1234</strong> as the code to see the output.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan6to7/leviathan6to7_5.webp' alt='Running the binary with code 1234.' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Running the binary with code '1234'.</figcaption></figure></div></div><br /><br />As expected it didn't work, now just like last challenge let's use <strong>ltrace</strong> to see what the binary is doing with the code, using command - <strong>ltrace ./leviathan6 1234</strong><br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan6to7/leviathan6to7_6.webp' alt='Output of ltrace.' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of command 'ltrace ./leviathan6 1234'.</figcaption></figure></div></div><br /><br />As per the output of <strong>ltrace</strong> the binary uses the <strong>atoi()</strong> function in the code, now the <strong>atoi()</strong> function is defined in the <strong>stdlib.h</strong> header file of <strong>C</strong>, the function converts a string input to an integer value. So it seems that here our command line argument <strong>123$</strong> is converted into integer and then processed ahead, but we can not see what it is doing with the integer value after conversion. <br /><br />Since it's only a 4 digit code, it can be easily brute forced using bash or any other language. I used <strong>bash</strong> because it is installed by default in linux, when attacking in a real world scenario, you may or may not find the language to your choosing, you will have to rely on what's been provided, since bash comes with linux, it will always be installed in the system. The bash code to brute force the 4 digit code - <br /><br /><pre class='line-numbers' style='max-height: 500px;'><code class='language-bash match-braces'>for i in {0000..9999}; do echo $i; ./leviathan6 $i; sleep 0.5; done\n</code></pre><br /><br />Here since I added an extra <strong>echo</strong> to check what code number we are on and added <strong>sleep</strong> to ensure that code doesn't run into any unknown time related issue.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan6to7/leviathan6to7_7.webp' alt='Bash code to brute-force code' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Bash code to brute-force code used by the binary.</figcaption></figure></div></div><br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan6to7/leviathan6to7_8.webp' alt='Initial runs of the code' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Initial runs of the bash code.</figcaption></figure></div></div><br /><br />Similar code in python - <br /><br /><pre class='line-numbers' style='max-height: 500px;'><code class='language-python match-braces'>from os import system\nfrom time import sleep\n\nfor i in range(0000, 10000):\n    print(\"i\")\n    system(f\"./home/leviathan6/leviathan6 {i}\")\n    sleep(0.5)\n</code></pre><br /><br />Here you will have to create a separate file in the <strong>/tmp/</strong> directory and run it, so that's why I had to use the full path of the binary.<br /><br />I won't show the 4 digit code here, as it will take out all the fun (It will take a little bit of time to brute-force it), but once the code has been cracked we will get a <strong>shell</strong>, just like in previous challenges. Using <strong>whoami</strong> command to see what user we are.<br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan6to7/leviathan6to7_9.webp' alt='Output of command whoami' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Output of command 'whoami'.</figcaption></figure></div></div><br /><br />As per the output we are <strong>leviathan7</strong>, we can now access the password file for leviathan7 using the command <strong>cat /etc/leviathan_pass/leviathan7</strong><br /><br /><div class='row'><div class='col' style='text-align: center;'><figure class='figure' style='align-items: center;'><img src='static/images/OverTheWire-WriteUps/Leviathan/leviathan6to7/leviathan6to7_10.webp' alt='Output of command cat' onclick='magnify(this.src)' class='figure-img img-fluid blog-image'><figcaption class='figure-caption blog-fig-caption'>Using command 'cat' to see the password of leviathan7.</figcaption></figure></div></div><br /><br /><strong>Password for leviathan7 is: ahy7MaeBo9</strong>"}