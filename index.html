<html>

<head>
    <title>
        Blog :=)
    </title>
    <!-- Jquery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!-- Jquery Ends-->

    <!-- Bootstrap CSS and JS-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
        crossorigin="anonymous"></script>
    <!-- Bootstrap CSS and JS Ends -->

    <!-- @TODO: Clean this mess -->
    <!-- Custom BG  Style -->
    <!-- <link href="static/css/bg_parllax_stars.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'> -->
    <!-- <link href="static/worm_bg/worm_bg.css" rel="stylesheet"> -->
    <!-- Custom BG  Style Ends -->

    <!-- version 1.0 style -->
    <!-- @TODO: If large shift to a css file -->
    <link href="static/default/css/deafult.css" rel="stylesheet">
    <!-- version 1.0 style Ends -->
</head>

<body>
    <!-- version 1.0 -->
    <!-- Description: this version will contain the base design like, a solid bg, animated bg will come out in future versions-->
    <div class="row container-fluid">
        <div class="col-sm-9">
            <div class="container-fluid" id="blog-card-holder"></div>
        </div>
        <div class="col-sm-3">
            <div class="container-fluid blog_card">
                <div class="card text-justify" id="side-panel">

                    <div class="card-body blog-card">
                        <h3 class="card-title">Archives</h3>
                        <br />
                        <h4>View by Date: </h4>
                        <h5 class="card-text"> Jan 2020</h5>
                        <h5 class="card-text"> Feb 2020</h5>
                        <h5 class="card-text"> Mar 2020</h5>
                        <h5 class="card-text"> Jun 2020</h5>
                        <h5 class="card-text"> Jul 2020</h5>
                        <h5 class="card-text"> Apr 2020</h5>

                        <br />

                        <h4>View by Tag(s): </h4>
                        <span class="badge rounded-pill tag tag-color">Tag 1 </span>
                        <span class="badge rounded-pill tag tag-color">Tag 2</span>
                        <span class="badge rounded-pill tag tag-color">Tag 3</span>
                        <span class="badge rounded-pill tag tag-color">Tag 4</span>

                        <br /> <br />

                        <h4>Popular: </h4>
                        <h5 class="card-text"> Blog Title 1</h5>
                        <h5 class="card-text"> Blog Title 2</h5>
                        <h5 class="card-text"> Blog Title 3</h5>
                        <h5 class="card-text"> Blog Title 4</h5>
                        <h5 class="card-text"> Blog Title 5</h5>
                        <h5 class="card-text"> Blog Title 6</h5>

                    </div>

                </div>
            </div>
        </div>
    </div>
    <!-- version 1.0 Ends -->

    <script type="text/javascript">
        fetch('static/meta_data/blog_meta_data.json')
            .then(function (response) {
                return response.json();
            })
            .then(function (data) {
                try {
                    // sending specific json data to the processing function
                    process_meta_data(data);
                }
                catch (err) {
                    // try fetching the specific data from the json
                    // if record not found then
                    // redirect to error.html page
                    // error code 1501 - Invalid Blog ID
                    // window.location.replace("error.html?err_code=1501");
                    console.log(err)
                }
            })
            .catch(function (err) {
                console.log("error" + err);
            });

        function process_meta_data(meta_data) {
            //console.log(meta_data);
            blog_card_holder_container = document.getElementById("blog-card-holder");
            const blog_ids = Object.keys(meta_data);
            blog_ids.reverse();

            for (var i = 0; i < blog_ids.length; i++) {

                const blog_id = blog_ids[i];
                const blog_title = meta_data[blog_id].blog_title;
                const blog_author = meta_data[blog_id].blog_author;
                const blog_publish_date = meta_data[blog_id].blog_publish_date;
                const blog_tags = meta_data[blog_id].blog_tags;
                const blog_summary = meta_data[blog_id].blog_summary;
                
                var div1 = document.createElement("div");
                div1.setAttribute("class", "row blog_card");

                var div2 = document.createElement("div");
                div2.setAttribute("class", "col");

                var div3 = document.createElement("div");
                div3.setAttribute("class", "card text-justify");

                var div4 = document.createElement("div");
                div4.setAttribute("class", "card-body blog-card");

                var blog_title_container = document.createElement("h3");
                blog_title_container.setAttribute("class", "card-title");
                blog_title_container.innerHTML = blog_title;

                var blog_author_container = document.createElement("p");
                blog_author_container.setAttribute("class", "card-text");
                blog_author_container.innerHTML = "Author: "+blog_author;

                var blog_date_container = document.createElement("p");
                blog_date_container.setAttribute("class", "card-text");
                blog_date_container.innerHTML = "Date Published: " + blog_publish_date;

                var blog_tags_container = document.createElement("p");
                blog_tags_container.setAttribute("class", "card-text");
                blog_tags_container.innerHTML = "Tags: ";
                for (var j = 0; j < blog_tags.length; j++) {
                        var span = document.createElement("span");
                        span.setAttribute("class", "badge rounded-pill tag tag-color");
                        span.innerHTML = blog_tags[j];
                        blog_tags_container.appendChild(span);
                    }

                var blog_summary_container = document.createElement("h5");
                blog_summary_container.setAttribute("class", "card-text");
                blog_summary_container.innerHTML = blog_summary+" ";

                var read_more_button = document.createElement("a");
                read_more_button.setAttribute("href", "view.html?id="+blog_id);
                read_more_button.innerHTML = "Read More"
                blog_summary_container.append(read_more_button);
                    
                
                div4.append(blog_title_container);
                div4.append(blog_author_container);
                div4.append(blog_date_container);
                div4.append(blog_tags_container);
                div4.append(blog_summary_container);

                div3.append(div4);
                div2.append(div3);
                div1.append(div2);
                
                blog_card_holder_container.append(div1);
            }
        }

    </script>
</body>

</html>

<!-- 
    TODO:
    1. Pagination
    2. Error codes in views.html 
    3. create error.html
-->